#!/usr/local/plan9/bin/rc
# window manager improved 2 wrapper

if(! ~ $#* 0) {
    exec wmiiwm $*
}

if(! wmiiwm -c) {
    exit 1  # wmiiwm is already running or $DISPLAY is unset
}

old_path=$path
path=($HOME/.wmii-3 CONFPREFIX/wmii-3 9PREFIX/bin $path)
WMII_ADDRESS=unix!/tmp/ns.$USER.$DISPLAY/wmii

# start window manager and utilities:
mkdir -m 700 -p /tmp/ns.$USER.$DISPLAY
wmiiwm -a $WMII_ADDRESS &
wmiipid=$apid

# display the wmii introduction if necessary:
if(mkdir $HOME/.wmii-3 >[2]/dev/null) {
    welcome &
}

# run configuration:
sleep 1
wmiirc &

# wait for wmiifs's termination:
wait $wmiipid
