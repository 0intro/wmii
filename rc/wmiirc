#!9PREFIX/bin/rc -x
# configure wmii

CLIENT_BAR=0
CLIENT_BORDER=3
HANDLEINC=1

SEL_COLOR="#ffffff #555588 #8888bb"
NORM_COLOR="#dddddd #666666 #999999"
FONT="fixed"

fn xwrite { echo -n $2 | wmiir write $1 }

# WMIIWM CONFIGURATION
xwrite /wm/default/bar $CLIENT_BAR
xwrite /wm/default/border $CLIENT_BORDER
xwrite /wm/default/font $FONT
xwrite /wm/default/selcolor $SEL_COLOR
xwrite /wm/default/normcolor $NORM_COLOR
for(page in `{wmiir read /wm | grep '^d' | awk '{print $10}'}) {
	for(area in `{wmiir read /wm/$page | grep '^d' | awk '{print $10}'}) {
		for(client in `{wmiir read /wm/$page/$area | grep '^d' | awk '{print $10}'}) {
			xwrite /wm/$page/$area/$client/bar $CLIENT_BAR
			xwrite /wm/$page/$area/$client/border $CLIENT_BORDER
		}
	}
}

# WMIIKEYS CONFIGURATION
cat | wmiir write /keys/reset <<END
Control-Alt-c 		echo -n kill | wmiir write /wm/sel/sel/sel/ctl
Control-Alt-q,y 	quit
Control-Alt-w,y 	wmiirc
Alt-t 				extern xterm -rv
Alt-d 				echo -n detach | wmiir write /wm/sel/sel/sel/ctl
Alt-a 				echo -n attach | wmiir write /wm/ctl
Shift-Alt-a 		echo -n detached | wmiir write /wm/ctl
Alt-n				wmiir read /wm/sel/new >/dev/null >[2=1]
Alt-m 				echo -n max | wmiir write /wm/sel/sel/sel/ctl
Alt-Return 			echo -n swap west | wmiir write /wm/sel/sel/ctl
Shift-Alt-Return 	echo -n swap east | wmiir write /wm/sel/sel/ctl
Control-Alt-y 		wmiir read /wm/new >/dev/null >[2=1]
Alt-h 				echo -n select next | wmiir write /wm/sel/ctl
Alt-l 				echo -n select prev | wmiir write /wm/sel/ctl
Alt-Tab 			echo -n select next | wmiir write /wm/sel/sel/ctl
Alt-j 				echo -n select next | wmiir write /wm/sel/sel/ctl
Alt-k 				echo -n select prev | wmiir write /wm/sel/sel/ctl
Shift-Alt-h			echo -n select prev | wmiir write /wm/ctl
Shift-Alt-l			echo -n select next | wmiir write /wm/ctl
Shift-Alt-p			echo -n pager | wmiir write /wm/ctl
Shift-Alt-1			echo -n select 1 | wmiir write /wm/ctl
Shift-Alt-2			echo -n select 2 | wmiir write /wm/ctl
Shift-Alt-3			echo -n select 3 | wmiir write /wm/ctl
Shift-Alt-4			echo -n select 4 | wmiir write /wm/ctl
Shift-Alt-5			echo -n select 5 | wmiir write /wm/ctl
Shift-Alt-6			echo -n select 6 | wmiir write /wm/ctl
Shift-Alt-7			echo -n select 7 | wmiir write /wm/ctl
Shift-Alt-8			echo -n select 8 | wmiir write /wm/ctl
Shift-Alt-9			echo -n select 9 | wmiir write /wm/ctl
END

xwrite /keys/font $FONT
xwrite /keys/color $SEL_COLOR

# WMIIBAR CONFIGURATION
xwrite /bar/font $FONT
xwrite /bar/defcolor $SEL_COLOR
echo -n fnord | wmiir write /bar/new/data 

# MISC
xsetroot -mod 2 2 -bg '#555588' -fg '#666666'
status&
